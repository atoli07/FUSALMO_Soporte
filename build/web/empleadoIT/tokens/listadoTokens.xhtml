<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>FUSALMO IT Portal - Tokens</title>
        <h:outputStylesheet library="css" name="style.css"/>
        <h:outputStylesheet library="css" name="primeflex.min.css" />
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"/>
    </h:head>
    <h:body class="firstBody">
        
        <menu class="menu">

            <div class="card">

                <h:form>

                    <p:menubar style="background-color: #299795; border-radius: 0%; border: none;">

                        <p:menuitem url="${request.contextPath}/faces/empleadoIT/bienvenidoEmpleado.xhtml">
                            
                            <h:outputLabel value="FUSALMO IT PORTAL" style="color: #DEE2E6; font-weight: bold;"/>

                        </p:menuitem>
                        
                        <f:facet name="options">
                            <p:button 
                                class="buttonLogout"
                                value="Salir" 
                                icon="pi pi-fw pi-sign-out" 
                                styleClass="ui-button-info" 
                                href="${request.contextPath}/faces/logout.jsp"
                                style="color: #DEE2E6; font-weight: bold;"
                                />
                        </f:facet>

                    </p:menubar>

                </h:form>

            </div>

        </menu>
        
        <div class="welcome">
            <div class="p-grid">
            <div class="title p-col-8">
                
                <h1 class="titleH1">Lista e historial<br/> de Tokens</h1>
                
            </div>
            <div class="image p-col-4">
                
                <h:graphicImage library="img" name="LogoFusalmo.png" class="styleImageHeader"/>
                    </div>
            </div>
            <p:divider class=""/>
            
        </div>

        <div class="container">
            <h1 class="titleH3" >Mis tokens</h1>
            <h:form class="p-grid">
                <p:dataTable id="tokens" var="token" value="#{tokensBean.getListaTokensByIdEmpleado(idEmpleado)}" 
                             rowKey="#{token.id}" selectionMode="single" selection="#{tokensBean.selectedToken}" stripedRows="true">
                    <p:column headerText="Fecha de creación">
                        <h:outputText value="#{token.fecha}">
                            <f:convertDateTime pattern="dd/MM/yyyy"/> 
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Equipo seleccionado">
                        <h:outputText value="#{token.seleccionRecurso.codActivo}"/>
                    </p:column>
                    
                    <p:column headerText="Detalle">
                        <h:outputText value="#{token.descripcion}"/>
                    </p:column>
                    
                    <p:column headerText="Bitácora de soporte">
                        <p:commandButton
                            update="prueba"
                            value="Detalles" 
                            oncomplete="$('#exampleModal').modal('show');" 
                            title="Ver campos" 
                            actionListener="#{tokensBean.mostrarDetalle(token.id)}">
                        </p:commandButton>
                    </p:column>
                    
                    <!--
                    
                    <p:column headerText="Bitácora de soporte">
                        <p:commandButton update="ventanaModal" value="Show" type="button" icon="pi pi-external-link" onclick="PF('dlg2').show()" actionListener="#{tokensBean.mostrarDetalle(token.id)}"/>
                    </p:column>
                    
                    
                    -->
                    
                    <!--
                    <p:column headerText="Detalle">
                        <h:outputText value="#{token.descripcion}"/>
                    </p:column>
                    <p:column headerText="Bitácora de soporte">
                            <p:commandButton value="Detalle" styleClass="ui-button-outlined ui-button-secondary"
                                             update="detalleBitacora" oncomplete="PF('detalle').show('#{component.clientId}');">
                                <f:setPropertyActionListener value="#{token}" target="#{tokensBean.selectedToken}"/>
                            </p:commandButton>
                        <p:overlayPanel widgetVar="detalle" showCloseIcon="true" dynamic="true">
                    <p:outputPanel id="detalleBitacora">
                    <div class="dialog">
                        <h:outputText value="#{tokensBean.selectedToken.idEstado.descripcion}"/>
                    </div>
                    <br/>
                    <p:commandButton value="Entendido" styleClass="ui-button-help" style="float: right"/>
                    </p:outputPanel>
                </p:overlayPanel>
                    </p:column>
                -->
                </p:dataTable>
                <div style="margin-top: 15px">
                    <p:commandButton value="CREAR TOKEN NUEVO" styleClass="ui-button-outlined ui-button-help"
                                     action="nuevoTokenEmpleado"/>
                    <p:button value="REGRESAR A MENÚ DE OPCIONES" styleClass="ui-button-outlined ui-button-info" href="#{request.contextPath}/faces/empleadoIT/bienvenidoEmpleado.xhtml" style="margin-left: 10px"/>
                </div>
            </h:form>
        </div>
        
        <p:dialog header="Header" widgetVar="dlg2" minHeight="40" width="350" showEffect="fade" modal="true" id="ventanaModal">
            
            <p class="p-m-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
                cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            
        </p:dialog>
        
        <p:outputPanel id="prueba">
            
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Estado: <b style="color: green">#{tokensBean.selectedToken.idEstado.nombre}</b></h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            #{tokensBean.selectedToken.idEstado.descripcion}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </p:outputPanel>
        
    </h:body>
</html>